<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cartas Imprim√≠veis - S√≠tio do Pica-Pau Amarelo</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial,sans-serif;margin:0;padding:1rem;background:#f5f5f5}
    .header{text-align:center;margin-bottom:2rem}
    .header h1{color:#8B4513;margin:0;font-size:2.5rem}
    .page{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;max-width:1000px;margin:0 auto}
    .gallery{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;max-width:1000px;margin:0.5rem auto 2rem}
    .card{border:3px solid #8B4513;border-radius:16px;aspect-ratio:3/4;display:flex;flex-direction:column;align-items:center;justify-content:center;font-weight:900;background:#fff;box-shadow:0 4px 8px rgba(0,0,0,0.1);padding:8px}
    .card img{max-width:80%;max-height:70%;object-fit:contain;border-radius:8px}
    .card .name{margin-top:8px;font-size:0.9rem;text-align:center;color:#8B4513}
    .hint{margin:1rem 0;font-weight:700;text-align:center;background:#FFD700;padding:1rem;border-radius:8px;color:#8B4513}
    .print-btn{background:#32CD32;color:white;border:none;padding:10px 20px;border-radius:8px;font-weight:bold;cursor:pointer;margin-left:10px}
    .print-btn:hover{background:#28a745}
    @media print{.hint,.print-btn{display:none} body{padding:0;background:white} .page{gap:8px}}
    @media (max-width: 768px){.page{grid-template-columns:repeat(3,1fr)} .gallery{grid-template-columns:repeat(3,1fr)} .card{font-size:0.8rem}}
    @media (max-width: 480px){.page{grid-template-columns:repeat(2,1fr)} .gallery{grid-template-columns:repeat(2,1fr)}}
  </style>
  <meta name="robots" content="noindex" />
  <meta name="color-scheme" content="light" />
  <meta name="description" content="Cartas imprim√≠veis de alto contraste para o jogo de mem√≥ria do S√≠tio do Pica-Pau Amarelo." />
  <link rel="icon" href="favicon.ico" />
  <meta name="x-robots-tag" content="noai, noimageai" />
  <meta http-equiv="Permissions-Policy" content="interest-cohort=()" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline'; script-src 'unsafe-inline'; img-src 'self' data: blob:;" />
  
</head>
<body>
  <div class="header">
    <h1>üè° Cartas do S√≠tio do Pica-Pau Amarelo</h1>
  </div>
  
  <div class="hint">
    Imprima em papel A4, recorte nas bordas e use em ambiente claro para melhor detec√ß√£o pela IA. 
    <button class="print-btn" id="printBtn">üñ®Ô∏è Imprimir</button>
  </div>
  
  <div class="page" id="grid"></div>
  
  <h2 class="section-title" style="text-align:center;color:#8B4513;margin:1.25rem 0 0.5rem 0;">Visualiza√ß√£o de todas as cartas</h2>
  <div class="gallery" id="gallery"></div>
  
  <script>
    const characters = [
      { name: 'Em√≠lia', img: './characters/emilia.png' },
      { name: 'Narizinho', img: './characters/narizinho.png' },
      { name: 'Pedrinho', img: './characters/pedrinho.png' },
      { name: 'Visconde', img: './characters/visconde.png' },
      { name: 'Dona Benta', img: './characters/dona_benta.png' },
      { name: 'Tia Nast√°cia', img: './characters/tia_nastacia.png' },
      { name: 'Saci', img: './characters/saci.png' },
      { name: 'Cuca', img: './characters/cuca.png' },
      { name: 'Rabic√≥', img: './characters/rabico.png' },
      { name: 'Tio Barnab√©', img: './characters/barnabe.png' },
      { name: 'Quindim', img: './characters/quindim.png' },
      { name: 'Conselheiro', img: './characters/conselheiro.png' }
    ];

  const grid = document.getElementById('grid');
  const gallery = document.getElementById('gallery');
    
    const createCard = (character) => {
      const card = document.createElement('div');
      card.className = 'card';
      
      const img = document.createElement('img');
      img.src = character.img;
      img.alt = character.name;
      img.onerror = function() {
        this.style.display = 'none';
        const placeholder = document.createElement('div');
        placeholder.textContent = 'üè°';
        placeholder.style.fontSize = '3rem';
        this.parentElement.appendChild(placeholder);
      };
      
      const name = document.createElement('div');
      name.className = 'name';
      name.textContent = character.name;
      
      card.appendChild(img);
      card.appendChild(name);
      
      return card;
    };

    // Cria duas c√≥pias de cada personagem (para formar os pares)
    const allCards = [...characters, ...characters];
    
    // Embaralha as cartas
    for (let i = allCards.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [allCards[i], allCards[j]] = [allCards[j], allCards[i]];
    }
    
    // Adiciona todas as cartas √† grid (pares, embaralhadas) para impress√£o
    allCards.forEach(character => {
      grid.appendChild(createCard(character));
    });

    // Mostra uma galeria com todas as cartas (uma de cada), viradas (frente)
    characters.forEach(character => {
      gallery.appendChild(createCard(character));
    });

    // Utilit√°rio para baixar um Blob com nome
    function downloadBlob(blob, filename) {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // Baixa todos os PNGs dos personagens
    async function downloadAllCards() {
      for (const c of characters) {
        try {
          const res = await fetch(c.img, { cache: 'no-store' });
          const blob = await res.blob();
          const fname = (c.img.split('/').pop()) || 'carta.png';
          downloadBlob(blob, fname);
        } catch (e) {
          console.warn('Falha ao baixar', c.img, e);
        }
      }
    }

    // Clique em imprimir: baixa todas e chama o print
    document.getElementById('printBtn')?.addEventListener('click', async () => {
      // dispara downloads em sequ√™ncia e imprime em seguida
      downloadAllCards().catch(()=>{});
      setTimeout(() => window.print(), 400);
    });
  </script>
</body>
</html>
